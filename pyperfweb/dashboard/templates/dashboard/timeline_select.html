{% extends 'dashboard/base.html' %}

{% block title %}Select Timeline Session - PyPerf Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4"><i class="fas fa-chart-line"></i> System Performance Timeline</h1>
    
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">Select a Session with System Monitoring Data</h5>
        </div>
        <div class="card-body">
            {% if sessions %}
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Session ID</th>
                                <th>Hostname</th>
                                <th>Platform</th>
                                <th>Duration</th>
                                <th>Start Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for session in sessions %}
                            <tr>
                                <td><code>{{ session.session_id|truncatechars:12 }}</code></td>
                                <td>{{ session.hostname }}</td>
                                <td>
                                    <span class="badge bg-secondary">{{ session.platform|default:"Unknown" }}</span>
                                </td>
                                <td>{{ session.duration_str|default:"N/A" }}</td>
                                <td>{{ session.start_time|date:"Y-m-d H:i:s" }}</td>
                                <td>
                                    <a href="{% url 'dashboard:timeline_viewer' %}?session_id={{ session.session_id }}" 
                                       class="btn btn-sm btn-primary">
                                        <i class="fas fa-chart-area"></i> View Timeline
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i> No sessions with system monitoring data found.
                    <br><br>
                    To collect system monitoring data, use the PyPerf SystemMonitor:
                    <pre class="mt-3"><code>from py_perf import SystemMonitor

monitor = SystemMonitor(sample_interval=0.5)
monitor.start_monitoring()
# ... your code ...
monitor.stop_monitoring()
monitor.save_timeline_data()</code></pre>
                </div>
            {% endif %}
        </div>
    </div>
    
    <div class="mt-4">
        <a href="{% url 'dashboard:home' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>
</div>
{% endblock %}